# ğŸ² KUJIKUJI - Interactive 3D Lottery

**KUJI (ãã˜)** means "lottery" in Japanese. An interactive 3D lottery application with animated robot characters, cinematic effects, and smooth transitions.

ğŸ® **[Live Demo](https://siriz.github.io/kujikuji/)** | ğŸ“– **Read this in other languages**: [í•œêµ­ì–´](README.ko.md) | [æ—¥æœ¬èª](README.ja.md)

![Concept Image](kuji_concept.png)
*Concept image generated by Google Gemini (Nano Banana)*

![WebGL](https://img.shields.io/badge/WebGL-990000?style=for-the-badge&logo=webgl&logoColor=white)
![JavaScript](https://img.shields.io/badge/JavaScript-F7DF1E?style=for-the-badge&logo=javascript&logoColor=black)

## âœ¨ Features

- ğŸ­ **3D Animated Characters** - Interactive robot models with random animations
- ğŸ² **Random Lottery System** - Fair selection with dramatic reveals
- âœ¨ **Particle Effects** - Gold bursts, sparkles, and firework celebrations
- ğŸ“¸ **Unique Avatars** - DiceBear integration for each character
- ğŸ’¾ **Auto-Save** - LocalStorage persistence for progress tracking
- ğŸ“± **Responsive Design** - Works on desktop and mobile
- ğŸ¬ **Cinematic Transitions** - Smooth camera movements and lighting effects
- ğŸ“Š **Progress Tracking** - Real-time statistics display
- ğŸŒ **Multi-Language Support** - English, Japanese (æ—¥æœ¬èª), Korean (í•œêµ­ì–´) with URL parameter support

## ğŸŒ Language Support

KUJIKUJI supports three languages with automatic detection and persistence:

### Supported Languages

- ğŸ‡ºğŸ‡¸ **English** (default)
- ğŸ‡¯ğŸ‡µ **Japanese (æ—¥æœ¬èª)**
- ğŸ‡°ğŸ‡· **Korean (í•œêµ­ì–´)**

### How to Change Language

#### Method 1: Using the Language Selector

Click the language dropdown (ğŸŒ) in the top-right corner of any page and select your preferred language. Your choice is automatically saved to localStorage.

#### Method 2: Using URL Parameters

You can set the language directly via URL parameters:

```
# English
http://localhost:8000/index.html?lang=en

# Japanese
http://localhost:8000/index.html?lang=ja

# Korean
http://localhost:8000/index.html?lang=ko
```

This works on both `index.html` and `select.html` pages.

### Implementation Details

- **Translation Files**: `locales/translations.json` - JSON-based translation system
- **i18n Module**: `js/i18n.js` - Handles language loading, switching, and DOM updates
- **Persistence**: Language preference is saved to localStorage as `preferredLanguage`
- **Dynamic Updates**: All text content updates instantly when language changes
- **Attributes**: Uses `data-i18n` and `data-i18n-placeholder` attributes for automatic translation

## ğŸ® How to Use

### Step 1: Add Characters (`index.html`)

![Character Input Screen](kuji_list.png)

Choose one of three input methods:

1. **Number Generation**: Enter a number (1-50) to auto-generate characters named "User 1", "User 2", etc.
2. **Text Paste**: Copy and paste names from Excel or a text file (one name per line)
3. **Manual Addition**: Click the "+ Add" button to add characters one by one

Each character gets a unique robot avatar from DiceBear. You can edit names or delete characters before starting.

### Step 2: Start the Lottery (`select.html`)

![Lottery Selection Screen](kuji_play.png)

1. Click the **"Start"** button to proceed to the 3D scene
2. Characters are randomly arranged in a circular pattern
3. The camera smoothly descends to reveal all characters
4. Watch as characters perform random animations

### Step 3: Make Selections

![Selected Character Screen](kuji_selected.png)

1. Click the **"GO"** button to randomly select a character
2. Enjoy the dramatic reveal:
   - Background darkens
   - Spotlight focuses on the winner
   - Particle effects burst
   - Character performs emotes
   - Name card flips to reveal identity

3. Click **"RETURN"** to go back to the overview
4. Repeat until all characters are selected

### Step 4: Completion

- Progress is tracked in the top-left corner
- When all characters are selected, you'll be prompted to restart
- All data persists in localStorage between sessions

## ğŸš€ Getting Started

### Prerequisites

- A modern web browser with WebGL support
- LocalStorage enabled
- Local web server (or use the methods below)

### Installation

1. Clone the repository:
```bash
git clone https://github.com/siriz/kujikuji.git
cd kujikuji
```

2. Serve the files using a local web server:

**Option 1: Using Python**
```bash
# Python 3
python -m http.server 8000

# Python 2
python -m SimpleHTTPServer 8000
```

**Option 2: Using Node.js**
```bash
npx http-server
```

**Option 3: Using VS Code**
- Install the "Live Server" extension
- Right-click on `index.html` and select "Open with Live Server"

3. Open your browser and navigate to:
```
http://localhost:8000
```

## ğŸ“ Project Structure

```
kujikuji/
â”œâ”€â”€ index.html          # Character input screen (entry point)
â”œâ”€â”€ select.html         # Main 3D lottery selection scene
â”œâ”€â”€ test/
â”‚   â””â”€â”€ robot.html     # Debug tool for avatar positioning
â”œâ”€â”€ css/
â”‚   â”œâ”€â”€ main.css                # Global stylesheet
â”‚   â”œâ”€â”€ select.css              # Select page specific styles
â”‚   â””â”€â”€ language-selector.css   # Language selector dropdown styles
â”œâ”€â”€ js/
â”‚   â”œâ”€â”€ main.js        # Main 3D scene logic
â”‚   â”œâ”€â”€ storage.js     # LocalStorage data management
â”‚   â”œâ”€â”€ utils.js       # Utility functions (positioning, collision detection)
â”‚   â”œâ”€â”€ particles.js   # Particle effect system
â”‚   â””â”€â”€ i18n.js        # Internationalization system
â”œâ”€â”€ locales/
â”‚   â””â”€â”€ translations.json       # Multi-language translations (en/ja/ko)
â”œâ”€â”€ libs/
â”‚   â”œâ”€â”€ gsap/
â”‚   â”‚   â””â”€â”€ gsap.min.js    # GSAP animation library (local)
â”‚   â””â”€â”€ threejs/       # Three.js library files
â”‚       â”œâ”€â”€ build/
â”‚       â”‚   â””â”€â”€ three.module.js
â”‚       â””â”€â”€ jsm/       # Three.js addons and utilities
â”‚           â”œâ”€â”€ controls/      # OrbitControls
â”‚           â”œâ”€â”€ loaders/       # GLTFLoader, FontLoader
â”‚           â”œâ”€â”€ geometries/    # TextGeometry
â”‚           â””â”€â”€ libs/          # Stats, GUI
â”‚       â”œâ”€â”€ models/            # 3D model files
â”‚       â”‚   â””â”€â”€ gltf/
â”‚       â”‚       â””â”€â”€ RobotExpressive/
â”‚       â””â”€â”€ fonts/             # Font files for 3D text
â”‚           â””â”€â”€ optimer_bold.typeface.json
â”œâ”€â”€ models/            # 3D model files
â”‚   â””â”€â”€ gltf/
â”‚       â””â”€â”€ RobotExpressive/
â””â”€â”€ fonts/             # Font files for 3D text
    â””â”€â”€ optimer_bold.typeface.json
```

## ğŸ› ï¸ Technologies Used

- **Three.js** - 3D graphics library
- **GSAP** - Animation library
- **DiceBear API** - Avatar generation
- **WebGL** - Hardware-accelerated 3D rendering
- **LocalStorage** - Client-side data persistence
- **i18n System** - JSON-based internationalization (en/ja/ko)

*See the [License](#-license) section below for detailed third-party library information and licenses.*

## ğŸ”§ Development & Debugging

### Avatar Positioning Tool

For developers who want to adjust the robot avatar positioning, we provide a debug tool:

**Location**: `test/robot.html`

**Features**:
- Real-time avatar position adjustment (X, Y, Z with 0.001 precision)
- Rotation controls (X, Y, Z with 0.1Â° precision)
- 50-state undo/redo system
- Visual wireframe helpers for Head_3 bone
- Interactive controls with immediate feedback

**Usage**:
```bash
# Start local server (if not already running)
python -m http.server 8000

# Open in browser
http://localhost:8000/test/robot.html
```

Use the sliders and input fields to fine-tune the avatar plane position and rotation. Changes can be undone/redone using the buttons or keyboard shortcuts (Ctrl+Z / Ctrl+Y).

## ğŸ¨ Customization

### Adding Your Own Character Names

1. Open `index.html`
2. Use any of the three input methods
3. Characters are automatically saved to localStorage

### Adjusting Visual Effects

Edit `js/particles.js` to customize particle effects. Available effects:

#### 1. **Confetti Burst** ğŸŠ (NEW!)
Colorful confetti pieces exploding from the center like fireworks:
```javascript
ParticleEffects.createConfettiBurst(scene, position, {
    particleCount: 150,
    explosionForce: 0.4,
    duration: 4.5
});
```

#### 2. **Confetti Rain** ğŸŒ§ï¸ (NEW!)
Confetti falling gently from the sky with swaying motion:
```javascript
ParticleEffects.createConfettiRain(scene, camera, {
    particleCount: 120,
    duration: 6,
    fallSpeed: 0.025
});
```

#### 3. **Full Celebration** ğŸ‰ (NEW!)
Combined effect with burst + rain for maximum celebration:
```javascript
ParticleEffects.createConfettiCelebration(scene, position, camera);
```

#### 4. **Selection Effect** âœ¨
Rising golden particles with spiral motion:
```javascript
ParticleEffects.createSelectionEffect(scene, position, {
    particleCount: 100,  // More particles
    color: 0xFF0000,     // Red particles
    duration: 3          // Longer animation
});
```

#### 5. **Firework Effect** ğŸ†
Explosive particle bursts with gravity:
```javascript
ParticleEffects.createFireworkEffect(scene, position, {
    particleCount: 120,
    explosionForce: 0.3
});
```

### Test the New Confetti Effects

A dedicated demo page is available to test all confetti effects:

**Location**: `test/confetti-demo.html`

**Features**:
- ğŸ’¥ **Confetti Burst**: Firework-style explosion
- ğŸŒ§ï¸ **Confetti Rain**: Gentle falling motion
- ğŸŠ **Full Celebration**: Combined burst + rain
- âœ¨ **Classic Effects**: Original particle system

**Usage**:
```bash
# Open in browser
http://localhost:8000/test/confetti-demo.html
```

Click the colorful buttons to trigger different effects. You can click multiple times to layer effects for spectacular celebrations!


### Changing Positioning Algorithm

Modify `js/utils.js` â†’ `generatePositions()`:
- Adjust `minDistance` for spacing
- Change layer spacing
- Modify circular/spiral patterns

## ğŸ“Š Data Management

### LocalStorage Structure

```json
{
  "characters": [
    {
      "id": "unique-id",
      "name": "Character Name",
      "avatarSeed": "random-seed",
      "selected": false,
      "selectedAt": null,
      "createdAt": "2025-10-26T..."
    }
  ],
  "selectedCharacters": [],
  "createdAt": "2025-10-26T...",
  "updatedAt": "2025-10-26T..."
}
```

### Data Operations

- **Export**: Click the "Export Data" button to download JSON backup
- **Reset**: Clear all data and start fresh
- **Persist**: Data automatically saves after each action

## ğŸ­ Animation States

The robots support various animation states:

- **States**: Idle, Walking, Running, Dance, Sitting, Standing, Death
- **Emotes**: Jump, Yes, No, Wave, Punch, ThumbsUp

Characters randomly perform these animations when not selected.

## ğŸ“± Browser Compatibility

- Chrome (recommended)
- Firefox
- Safari
- Edge
- Opera

**Note**: Requires WebGL support. Some older browsers or devices may not be compatible.

## ğŸ¤ Contributing

Contributions are welcome! Feel free to:

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## ğŸ“„ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

### Third-Party Licenses

This project uses the following external libraries and assets, each with their own licenses:

#### Three.js (MIT License)
- **Location**: `libs/threejs/`
- **License**: MIT License
- **URL**: https://threejs.org/
- **Copyright**: Copyright Â© 2010-2024 Three.js authors

#### GSAP (GreenSock Animation Platform)
- **Location**: `libs/gsap/`
- **License**: GreenSock Standard License (free for most use cases)
- **URL**: https://greensock.com/licensing/
- **Note**: Commercial projects may require a license

#### RobotExpressive 3D Model
- **Location**: `libs/models/gltf/RobotExpressive/`
- **Source**: Three.js Examples
- **License**: MIT License (as part of Three.js examples)
- **URL**: https://github.com/mrdoob/three.js/tree/master/examples/models/gltf

#### MgOpen Fonts (Optimer, Helvetiker)
- **Location**: `libs/fonts/`
- **License**: MgOpen License (Free for commercial and non-commercial use)
- **URL**: http://www.ellak.gr/fonts/MgOpen/
- **Copyright**: Copyright (c) 2004 by MAGENTA Ltd.
- **Note**: Free to use, copy, merge, publish, and distribute

#### DiceBear Avatars API
- **Service**: Avatar generation (external API)
- **License**: Free for personal and commercial use
- **URL**: https://www.dicebear.com/
- **Style Used**: bottts-neutral

All third-party components retain their original licenses. Please refer to their respective license files in the `libs/` directory for full license texts.

## ğŸ™ Acknowledgments

- Three.js team for the amazing 3D library and examples
- GSAP team for the smooth animation framework
- Robot model from Three.js examples (RobotExpressive)
- MgOpen Fonts project for beautiful typefaces
- DiceBear for the avatar generation API

## ğŸ“§ Contact

siriz - [@siriz](https://github.com/siriz)

Project Link: [https://github.com/siriz/kujikuji](https://github.com/siriz/kujikuji)

---

Made with â¤ï¸ and Three.js
